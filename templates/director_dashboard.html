<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± - Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;600;800&display=swap');
    *{box-sizing:border-box}
    body{margin:0;font-family:"Cairo",sans-serif;min-height:100vh;background:#ffffff;color:#333;padding-top:140px}
    .container{max-width:1100px;margin:28px auto;padding:16px}
    h1{margin:0 0 10px 0;font-size:26px}
    .card{background:#f9f9f9;border-radius:14px;padding:16px;box-shadow:0 10px 24px rgba(0,0,0,0.1);border:1px solid #e0e0e0}
    table{width:100%;border-collapse:collapse;background:#fff;color:#222;border-radius:12px;overflow:hidden}
    th,td{padding:10px;text-align:right;font-size:15px}
    thead{background:#f4f5fb}
    tr+tr{border-top:1px solid #eee}
    .status-pill{padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px}
    .accepted{background:#e6ffed;color:#0b8f3d}
    .rejected{background:#ffe6e6;color:#b10000}
    .pending{background:#fff4d6;color:#a85b00}
    .actions{display:flex;gap:8px}
    .btn{border:none;border-radius:10px;padding:8px 12px;font-weight:700;cursor:pointer}
    .btn-accept{background:#16a34a;color:#fff}
    .btn-reject{background:#ef4444;color:#fff}
    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    a.link{color:#333;text-decoration:none}

    .cognia-badges {
        position: fixed;
        top: 10px;
        left: 10px;
        z-index: 10000;
        display: flex;
        gap: 8px;
        align-items: flex-start;
    }

    .cognia-badges img {
        height: 70px;
        width: auto;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        transition: transform 0.3s ease;
    }

    .cognia-badges img:hover {
        transform: scale(1.05);
    }
  </style>
  </head>
  <body>
    <div class="cognia-badges">
      <img src="{{ url_for('static', filename='1.png') }}" alt="Cognia System of Distinction">
      <img src="{{ url_for('static', filename='Cognia.png') }}" alt="Cognia Accredited">
    </div>
    <div style="position:fixed; top:8px; right:14px; z-index:9999; text-align:right">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Ø§Ù„Ø´Ø¹Ø§Ø±" style="height:120px; display:block; margin:0; padding:0;">
        <div style="font-size:18px; color:#fff; background: linear-gradient(135deg, #fa709a, #fee140); padding:12px 20px; border-radius:20px; box-shadow:0 4px 15px rgba(0,0,0,0.2); margin-top:15px;">
            ğŸ‘¨â€ğŸ’¼ Ù…Ø±Ø­Ø¨Ø§ØŒ {% set user_name = current_user['name'] if current_user and current_user.get('name') else (current_user['username'] if current_user else 'Ø§Ù„Ù…Ø¯ÙŠØ±') %}{{ user_name }}
        </div>
    </div>
    <div class="container">
      <div class="topbar">
        <h1>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± - Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
        <div style="display:flex; gap:10px; align-items:center">
          {% if students %}
          <form method="POST" action="{{ url_for('director_delete_all_results') }}" onsubmit="return confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!');" style="margin:0">
            <button type="submit" style="background:linear-gradient(135deg,#ff6b6b,#ee5a6f);color:white;padding:10px 20px;border-radius:10px;font-size:14px;border:none;cursor:pointer;font-weight:bold">
              ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            </button>
          </form>
          {% endif %}
          <a class="link" href="{{ url_for('index') }}">â¬…ï¸ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        </div>
      </div>

      {% with msgs = get_flashed_messages() %}
        {% if msgs %}
          <div style="max-width:1100px;margin:0 auto 16px auto;background:#e9fbe9;color:#155724;border:1px solid #c3e6cb;padding:10px 14px;border-radius:10px;text-align:right;font-weight:700">
            {{ msgs[-1] }}
          </div>
        {% endif %}
      {% endwith %}

      <div class="card">
        {% if not students %}
          <div style="padding:12px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù†ØªØ§Ø¦Ø¬ Ø­Ø§Ù„ÙŠØ§Ù‹.</div>
        {% else %}
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                <th>Ø§Ù„ØµÙ</th>
                <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª (4 Ù…ÙˆØ§Ø¯)</th>
                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
              </tr>
            </thead>
            <tbody>
              {% for s in students %}
                <tr>
                  <td>{{ loop.index }}</td>
                  <td>{{ s['student_name'] }}</td>
                  <td>{{ s['grade'] }}</td>
                  <td>{{ s['total_score'] }}</td>
                  <td>
                    {% set st = s['status'] or 'pending' %}
                    <span class="status-pill {{ 'accepted' if st=='accepted' else 'rejected' if st=='rejected' else 'pending' }}">
                      {{ 'Ù…Ù‚Ø¨ÙˆÙ„' if st=='accepted' else 'Ù…Ø±ÙÙˆØ¶' if st=='rejected' else 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©' }}
                    </span>
                  </td>
                  <td>
                    <div class="actions">
                      <form method="post" action="{{ url_for('director_accept', student_id=s['student_id']) }}">
                        <button class="btn btn-accept" type="submit">Ù‚Ø¨ÙˆÙ„</button>
                      </form>
                      <form method="post" action="{{ url_for('director_reject', student_id=s['student_id']) }}">
                        <button class="btn btn-reject" type="submit">Ø±ÙØ¶</button>
                      </form>
                    </div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% endif %}
      </div>
    </div>
    <div style="position:fixed; bottom:10px; left:0; right:0; text-align:center; font-weight:bold; font-size:16px; color:#333; padding:10px; background:#f9f9f9; z-index:9999; border-top:1px solid #e0e0e0">
      ØªØµÙ…ÙŠÙ… Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ø³Ø¨ Ø§Ù„Ø¢Ù„Ù‰ Ø¨Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø£Ù†Ø¬Ø§Ù„ Ø§Ù„Ø£Ù‡Ù„ÙŠØ©Â©
    </div>
  </body>
  </html>
